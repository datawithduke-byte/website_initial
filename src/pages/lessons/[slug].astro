---
import { getLessons } from "../../utils/collections.js";

export async function getStaticPaths() {
  const lessons = await getLessons();
  return lessons.map(l => ({
    params: { slug: l.url.split("/").filter(Boolean).pop() },
    props: { lesson: l }
  }));
}

const { lesson } = Astro.props;
const dateISO = lesson.date;

const [y, m, d] = dateISO.split("-").map(Number);
const ukFallback = new Intl.DateTimeFormat("en-GB", {
  year: "numeric",
  month: "2-digit",
  day: "2-digit",
}).format(new Date(Date.UTC(y, m - 1, d)));
---
<time datetime={dateISO} data-date={dateISO}>
  {ukFallback}
</time>
---

<article>
  <lesson.Content />
</article>
