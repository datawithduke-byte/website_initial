---
import "../styles/theme.css";
const { title = "Data with Duke"
  , description = "Learn data, analytics, and tech with Duke – tutorials, podcasts, and practical guides."
  , image = "/images/default-og.png" 
} = Astro.props;
import Header from "../components/Header.astro";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title} • {import.meta.env?.SITE_NAME ?? 'Data With Duke'}</title>
    <meta name="description" content={description} />

    <!--- Google AdSense Meta tag -->
    <meta name="google-adsense-account" content="ca-pub-6163690941030740">

    <!-- Open Graph (Facebook, LinkedIn, etc.) -->
    <meta property="og:title" content={title || "Data with Duke"} />
    <meta property="og:description" content={description || "Learn data, analytics, and tech with Duke – tutorials, podcasts, and practical guides."} />
    <meta property="og:type" content="website" />
    <meta property="og:url" content={`https://datawithduke.com${Astro.url.pathname}`} />
    <meta property="og:image" content={image || "/default-og.png"} />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content={title || "Data with Duke"} />
    <meta name="twitter:description" content={description || "Learn data, analytics, and tech with Duke – tutorials, podcasts, and practical guides."} />
    <meta name="twitter:image" content={image || "/default-og.png"} />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/favicon.png" />

    <script type="application/ld+json">
      {JSON.stringify({
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "Data with Duke",
        "url": "https://datawithduke.com",
        "logo": "https://datawithduke.com/favicon.png",
        "sameAs": [
          "https://www.youtube.com/@data_with_duke",
          "https://www.facebook.com/datawithduke",
          "https://www.instagram.com/datawithduke"
        ]
      })}
    </script>
  </head>
  <body>
    <Header />

    <main class="container">
      <slot />
    </main>

    <footer class="site">
      <div class="container">
        <p>&copy; {new Date().getFullYear()} Data with Duke. All rights reserved.</p>
      </div>
    </footer>

    <script async defer crossorigin="anonymous"
      src="https://connect.facebook.net/en_GB/sdk.js#xfbml=1&version=v18.0">
    </script>
    <script is:inline>
      (() => {
        const times = document.querySelectorAll('time[data-date]');
        if (!times.length) return;

        const locale =
          navigator.language ||
          navigator.userLanguage ||
          'en-GB';

        times.forEach(time => {
          const iso = time.getAttribute('data-date');
          if (!iso) return;

          // Prevent timezone shift (YYYY-MM-DD is NOT timezone-safe)
          const [year, month, day] = iso.split('-').map(Number);
          const date = new Date(Date.UTC(year, month - 1, day));

          time.textContent = new Intl.DateTimeFormat(locale, {
            year: 'numeric',
            month: '2-digit',
            day: '2-digit',
          }).format(date);
        });
      })();
    </script>

  </body>
</html>
